{% extends 'base.html' %}

{% block content %}
  <h1>Twoje najlepsze podejÅ›cia</h1>

  <form method="get" class="card filterbar">
    <div class="filter-grid">
      <div class="field">
        <label for="type">Rodzaj boju</label>
        <select id="type" name="type" class="input" onchange="this.form.submit()">
          <option value="">Wszystkie</option>
          {% for value,label in lift_types %}
            <option value="{{ value }}" {% if filters.type == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="field">
        <label for="sort">Sortowanie</label>
        <select id="sort" name="sort" class="input" onchange="this.form.submit()">
          <option value="weight_desc" {% if sort == 'weight_desc' %}selected{% endif %}>CiÄ™Å¼ar: malejÄ…co</option>
          <option value="weight_asc" {% if sort == 'weight_asc' %}selected{% endif %}>CiÄ™Å¼ar: rosnÄ…co</option>
        </select>
      </div>

    </div>
  </form>

  {% if not table_ready %}
    <div class="card warning">
      <p><strong>Uwaga:</strong> WyglÄ…da na to, Å¼e nie wykonano migracji bazy danych.</p>
      <p>Uruchom w terminalu: <code>python manage.py migrate</code></p>
    </div>
  {% endif %}

  {% if attempts %}
    <div class="grid">
      {% for a in attempts %}
        <a class="card card-link" href="{% url 'attempt_detail' a.pk %}">
          <header class="card-header">
            <span class="badge">{{ a.get_lift_type_display }}</span>
            <div class="right-meta">
              {% if a.video %}<span class="video-indicator" title="Ma nagranie">ðŸŽ¬</span>{% endif %}
              <time datetime="{{ a.date }}">{{ a.date }}</time>
            </div>
          </header>
          <div class="card-body">
            <div class="pr-value">{{ a.weight_kg }} kg</div>
            {% if a.notes %}
              <p class="notes">{{ a.notes|truncatechars:120 }}</p>
            {% endif %}
          </div>
        </a>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty">
      <p>Brak prÃ³b dla wybranych filtrÃ³w. <a href="{% url 'index' %}">WyczyÅ›Ä‡</a> lub <a href="{% url 'add_attempt' %}">dodaj pierwszÄ…</a>!</p>
    </div>
  {% endif %}
{% endblock %}
